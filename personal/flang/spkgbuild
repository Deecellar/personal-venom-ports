# description	: Fortran Compiler using LLVM IR
# depends	: llvm libunwind clang

name=flang
version=15.0.1
release=1
source="https://github.com/llvm/llvm-project/releases/download/llvmorg-$version/flang-$version.src.tar.xz https://github.com/llvm/llvm-project/releases/download/llvmorg-$version/libunwind-$version.src.tar.xz
		https://github.com/llvm/llvm-project/releases/download/cmake-$version/llvm-$version.src.tar.xz"

build() {
	mv cmake-$version.src cmake
	mv libunwind-$version.src libunwind
	cd $name-$version.src

	export CC=gcc
	export CXX=g++

	mkdir -v build
	cd       build
	
	cmake .. -G Ninja \
	    -DCMAKE_INSTALL_PREFIX=/usr \
	    -DCMAKE_BUILD_TYPE=Release \
	    -DLLVM_ENABLE_RTTI=ON \
	    -DLLVM_ENABLE_EH=ON \
	    -DLLVM_MAIN_SRC_DIR=$SRC/libunwind \
	    -Wno-dev
	ninja
	DESTDIR=$PKG ninja install	        

}
